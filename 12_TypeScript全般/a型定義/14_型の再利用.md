# [型の再利用](https://typescriptbook.jp/reference/type-reuse)

作成日 2025/09/04

TypeScriptは型から別の型を導き出す機能を持つ

## 1. [typeof型演算子](https://typescriptbook.jp/reference/type-reuse/typeof-type-operator)

変数から型を抽出する。JavaScriptのtypeof演算子と同じ名前だが別のもの

```javascript
const point = { x: 135, y: 35 };
type Point = typeof point;
// => type Point = { x: number, y: number};
```

## 2. [ReturnType&lt;T&gt;](https://typescriptbook.jp/reference/type-reuse/utility-types/return-type)

関数型`T`の戻り値を取得する

```javascript
type RetunType1 = ReturnType<() => string>;
// => type ReturnType1 = string

type ReturnType2 = ReturnType<(arg: string) => string | number>;
// => type ReturnType2 = string | number
```

多くは`typeof`と併用して実際の関数の戻り値を取得する

```javascript
const isEven = (num: number) => {
  return num / 2 === 0;
};
 
type isEvenRetType = ReturnType<typeof isEven>;
// => type isEvenRetType = boolean
```

## 3. [infer](https://typescriptbook.jp/reference/type-reuse/conditional-types/infer)

inferは「推論する」という意味で、extendsの右辺にのみ書くことができる

`ReturnType<T>`の例からinferを知る

```javascript
const request = (url: string): Promise<string> => {
  return fetch(url).then((res) => res.text());
};

type X = ReturnType<typeof request>;
// => type X = Promise<string>
```

`ReturnType<T>`の定義

```javascript
type ReturnType<T extends (...args: any) => any> = T extends (...args: any) => infer R ? R : any;
```

`(...args: any) => any`は一般的な関数の型を示す。`T`は任意の関数

右辺にある関数の型は戻り値の`any`が`infer R`に変わっている。`R`が型となる

型`T`が関数に割り当て可能である場合は、戻り値の型である`R`、そうでない場合は`any`を返す

## 4. Parameters（これだけ別の解説記事から）

解説記事 => [Parameters&lt;T&gt;, ConstructorParameters&lt;T&gt;>](https://zenn.dev/okunokentaro/articles/01gm8gvthtt1tv72qt59adwfpq)

`Parameters<T>`はTypeScript 3.1から追加されたUtility Typesのひとつ

`ReturnType<T>`とセットで覚えるべき

```javascript
type Parameters<T extends (...args: any) => any> = T extends (...args: infer P) => any ? P : never;

type ReturnType<T extends (...args: any) => any> = T extends (...args: any) => infer R ? R : any;
```

`ReturnType<T>`が関数の戻り値の型を返したのに対し、`Parameters<T>`は関数の引数の型を返す

```javascript
type T1 = Parameters<(v: string) => void>;
// => type T1 = [v: string]

type T2 = Parameters<(x: number, y: number) => number>;
// => type T2 = [x: number, y: number]
```

## 5. [keyof型演算子](https://typescriptbook.jp/reference/type-reuse/keyof-type-operator)

オブジェクトの型からプロパティ名を型として返す

```javascript
type Book = {
  title: string;
  price: number;
  rating: number;
};
type BookKey = keyof Book;
// => type BookKey = "title" | "price" | "rating";
```

## 6. [Mapped Types](https://typescriptbook.jp/reference/type-reuse/mapped-types)

Mapped Typesは主にユニオン型と組み合わせて使い、キーの制約として使う

```javascript
type SystemSupportLanguage = "en" | "fr" | "it" | "es";

type Butterfly = {
  [key in SystemSupportLanguage]: string;
};

const butterflies: Butterfly = {
  en: "Butterfly",
  fr: "Papillon",
  it: "Farfalla",
  es: "Mariposa",
  // de: "Schmetterling", 使用できない
};
```

## 7. InstanceType（これも別の解説記事から）

解説記事 => [TypeScript: Documentation - Utility Types](https://www.typescriptlang.org/docs/handbook/utility-types.html)

> Constructs a type consisting of the instance type of a constructor function in Type.

コンストラクター関数型のインスタンス型を取得する

`InstanceType<Type>`はTypeScript 2.8から追加されたUtility Typesのひとつ

```javascript
class C {
  x = 0;
  y = 0;
}
 
type T0 = InstanceType<typeof C>;
//   ^? type T0 = C
```
