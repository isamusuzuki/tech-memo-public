# 『ハイパーメディアシステム』を読む

作成日 2025/12/02

## 1. 書籍情報

『ハイパーメディアシステム～htmxとRESTによるシンプルで軽やかなウェブ開発』

Carson Gross, Adam Stepinski, Deniz Aksimsek 著、嶌田 喬行 訳

技術評論社 2025年6月発行

## 2. Big Sky Software

htmxの作者、『ハイパーメディアシステム』の著者

Homepage => [/// big sky software](https://bigsky.software/)

GitHub => [Big Sky Software](https://github.com/bigskysoftware)

## 3. 書籍のサンプルコード

A Demo Contacts Application

[bigskysoftware/contact-app](https://github.com/bigskysoftware/contact-app)

サンプルコードを動かしてみる

### 開発コンテナを追加する

.devcontainer/devcontainer.json

```json
{
    "name": "python3",
    "build": {
        "dockerfile": "./Dockerfile"
    },
    "customizations": {
        "vsocode": {
            "extensions": [
                "ms-python.python",
                "charliermarsh.ruff",
                "njpwerner.autodocstring",
                "shardulm94.trailing-spaces",
                "oderwat.indent-rainbow",
                "mechatroner.rainbow-csv"
            ],
            "settings": {
                "autoDocstring.docstringFormat": "numpy",
                "[python]": {
                    "editor.defaultFormatter": "charliermarsh.ruff",
                    "editor.formatOnSave": true,
                    "editor.codeActionsOnSave": {
                        "source.fixAll": "explicit",
                        "source.organizeImports": "explicit"
                    }
                },
                "terminal.integrated.env.linux": {
                    "PYTHONPATH": "${containerWorkspaceFolder}"
                },
                "python.analysis.extraPaths": [
                    "${containerWorkspaceFolder}/",
                    "${containerWorkspaceFolder}/.venv/lib/python3.12/site-packages/"
                ],
                "python.analysis.typeCheckingMode": "standard"
            }
        }
    }
}
```

.devcontainer/Dockerfile

```dockerfile
FROM python:3.12-slim-bookworm

RUN apt-get update

RUN pip install --upgrade pip

RUN groupadd --gid 1000 pyuser \
  && useradd --uid 1000 --gid pyuser --shell /bin/bash --create-home pyuser

ENV PATH /home/pyuser/.local/bin:$PATH

USER pyuser
```

### スクリプト実行

```bash
python --version
# Python 3.12.12

pip --version
# pip 25.3

# パッケージをインストールする
pip install -r requirements.txt

# パッケージのバージョンを固定する
pip freeze > requirements.txt

# Flaskを動かす
FLASK_APP=app.py flask run
# Running on http://127.0.0.1:5000
```

### エラーが出る。修正すべき箇所あり

templates/layout.html

```html
<!-- <link rel="stylesheet" href="https://the.missing.style/v0.2.0/missing.min.css"> -->
<link rel="stylesheet" href="https://unpkg.com/missing.css">
```

app.py

```python
# 134行目
# return render_template("index.html", contacts=contacts_set)
return render_template("index.html", contacts=contacts_set, archiver=Archiver.get())
```

### テンプレートファイルを分析する

```text
--contact-app/templates/
   |--edit.html   ... 編集フォーム、削除ボタン
   |--index.html  ... archive_ui取り込み、検索フォーム
   |                  選択削除フォーム、一覧テーブル、追加ボタン
   |--layout.html ... HTMLヘッダー、フラッシュメッセージ、
   |                  コンテントブロック
   |--new.html    ... 追加フォーム
   |--rows.html   ... 一覧テーブルの行ブロック
   `--show.html   ... 編集ボタン、戻りボタン
```

### ルーティングを分析する

| ルート               | メソッド | 戻しテンプレート                       |
| -------------------- | :------: | -------------------------------------- |
| `/contacts`          |   ALL    | index.html、検索フォームからはrow.html |
| `/contacts/new`      |   GET    | new.html                               |
| `/contacts/new`      |   POST   | 成功したら転送、失敗したらnew.html     |
| `contacts/{id}`      |   ALL    | show.html                              |
| `contacts/{id}/edit` |   GET    | edit.html                              |
| `contacts/{id}/edit` |   POST   | 成功したら転送、失敗したらedit.html    |
| `contacts/{id}`      |  DELETE  | 成功したら転送、失敗したら空文字       |
| `contacts/`          |  DELETE  | index.html                             |
