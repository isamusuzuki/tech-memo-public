# ネットワークドライブを割り当てる

作成日 2020/03/26

## バッチファイルを利用する

NET USE コマンドは、コマンドプロンプト、Powershell、Git Bash\
いずれのシェルでも使用可能

```bash
# ネットワークドライブの接続を設定する
NET USE X: \\192.168.2.100\公開フォルダ

# ネットワークドライブの一覧を表示する
NET USE

# ネットワークドライブの接続を解除する
NET USE Z: /delete
```

conn.bat

```bash
NET USE X: \\192.168.2.100\公開フォルダ
```

disconn.bat

```bash
NET USE X: /delete
```

main.py

```python
import subprocess

cmd = 'conn.bat'
proc = subprocess.Popen(cmd, shell=True)
print(f'process {proc.pid} starts: ネットワークドライブに接続しています')
proc.wait()

pass # => X:ドライブを使う

cmd = 'disconn.bat'
proc = subprocess.Popen(cmd, shell=True)
print(f'process {proc.pid} starts: ネットワークドライブを切断しています')
proc.wait()
```

**要注意** バッチファイルは、必ずシフト JIS で保存すること
