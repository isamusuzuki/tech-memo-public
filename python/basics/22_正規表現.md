# 正規表現を使いこなす

作成日 2019/11/01、更新日 2023/03/06

## 01. 正規表現の特殊文字

|  特殊文字   | 説明                                                 |
| :-----: | ---------------------------------------------------- |
|   `.`   | 改行以外の任意の文字にマッチする                     |
|   `^`   | 文字列の先頭にマッチする                             |
|   `$`   | 文字列の末尾にマッチする                             |
|   `*`   | 直前のものを 0 回以上繰り返したものにマッチする      |
|   `+`   | 直前のものを 1 回以上繰り返したものにマッチする      |
|   `?`   | 直前のものを 0 回か 1 回繰り返したものにマッチする   |
|  `{m}`  | 直前のものを m 回繰り返したものにマッチする          |
| `{m,n}` | 直前のものを m 回から n 回繰り返したものにマッチする |

## 02. `re.match()`メソッドを使う

ドキュメント => [re \-\-\- 正規表現操作 — Python 3\.8\.0 ドキュメント](https://docs.python.org/ja/3/library/re.html)

- マッチすると Match オブジェクトが返る
- マッチしないと None が返る
- `Match.group(n)`で、丸括弧で囲んだデータを取得できる

```python
import re


def match(txt):
    # バックスラッシュを使うためにraw文字列にする
    result = re.match(r'^t\d{5}-(.+)$', txt)
    print(result)
    if result:
        # 丸括弧で囲んだデータを取得できる
        print(result.group(1))


if __name__ == '__main__':
    match('t00000-atc1222')
    # => <re.Match object; span=(0, 14), match='t00000-atc1222'>
    # => atc1222

    match('t12345-atc-111')
    # => <re.Match object; span=(0, 14), match='t12345-atc-111'>
    # => atc-111

    match('t123-atc123456')
    # => None
```

## 03. `\d`を使ってはいけない

`\d`は全角数字にもマッチしてしまうので、半角数字だけにマッチさせたい場合は`[0-9]`を使うべき

解説記事 => [Python 3 の正規表現で \d を使うな！](https://qiita.com/msmhrt/items/99b7ae276886ea9ff140)

```python
# ゼロを含まない自然数（正の整数）
regex1 = re.match(r'^[1-9][0-9]*$', txt)

# ゼロを含む正の整数
regex2 = re.match(r'^[1-9][0-9]*|0$', txt)

# 整数（正と負そしてゼロ）
regex3 = re.match(r'^-?[1-9][0-9]*|0$', txt)
```
