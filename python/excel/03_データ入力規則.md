# Excel のデータ入力規則を openpyxl で作成する

作成日 2021/11/09

## 01. Excel のデータ入力規則とは

データメニュー ＞ 「データツール」エリア ＞ 「データの入力規則」コマンド

「データの入力規則」ダイアログ登場 ＞ 設定タブ ＞ 「条件の設定」エリア

- 入力値の種類: リスト
- 空白を無視する: チェックオン
- ドロップダウン リストから選択する: チェックオン
- 元の値: `対象外,対象`

OKボタンをクリック

=> 「対象外」「対象」以外の言葉を入力できなくなる

英語では Data Validation というらしい

## 02. openpyxl のドキュメントを読む

[Validating cells — openpyxl 3\.0\.9 documentation](https://openpyxl.readthedocs.io/en/stable/validation.html)

サンプルコード

```python
from openpyxl import Workbook
from openpyxl.worksheet.datavalidation import DataValidation

wb = Workbook()
ws = wb.active

dv = DataValidation(type="list", formula1='"Dog,Cat,Bat"', allow_blank=True)

dv.add('I3:I24')

# ws.add_data_validation(dv)
ws.data_validataions.append(dv)
```
