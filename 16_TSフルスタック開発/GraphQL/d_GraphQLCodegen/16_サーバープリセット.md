# サーバープリセット

作成日 2025/10/09

## 1. 公式ガイド（英語）を写経する

[Guide: GraphQL Yoga / Apollo Server with Server Preset](https://the-guild.dev/graphql/codegen/docs/guides/graphql-server-apollo-yoga-with-server-preset)

GraphQL Code Generatorのサーバープリセットは`@eddeee888/gcg-typescript-resolver-files`であり、どのスケールレベルであれ、GraphQL APIが動作する手助けをする

### プロジェクトを用意する

```bash
mkdir hango
cd hango
npm init -y

npm i -D typescript @types/node
npx tsc --init
```

package.jsonを変更 => `{"type": "module"}`

tsconfig.jsonを編集する

```json
{
    "module": "esnext",  // <= nodenext
    "moduleResolution": "bundler", // NEW
    "verbatimModuleSyntax": false, // <= true
}
```

### GraphQLスキーマを書く

```text
--hango/
    `--src/
        |--base/
        |   `--schema.graphql
        |--user/
        |   `--schema.graphql
        `--book/
            `--schema.graphql
```

```javascript
// src/schema/base/schema.graphql
type Query
type Mutation

// src/schema/user/schema.graphql
extend type Query {
  user(id: ID!): User
}
type User {
  id: ID!
  fullName: String!
  isAdmin: Boolean!
}

// src/schema/book/schema.graphql
extend type Query {
  book(id: ID!): Book
}
extend type Mutation {
  markBookAsRead(id: ID!): Book!
}
type Book {
  id: ID!
  isbn: String!
}
```

GraphQLパッケージ群のインストール

```bash
npm i -D @graphql-codegen/cli
npm i -D @eddeee888/gcg-typescript-resolver-files
npm i -D graphql-scalars
```

codegen.tsの作成

```javascript
import type { CodegenConfig } from '@graphql-codegen/cli';
import { defineConfig } from '@eddeee888/gcg-typescript-resolver-files';

const config: CodegenConfig = {
    schema: './src/**/*.graphql',
    generates: {
        './src/schema': defineConfig(),
    },
};

export default config;
```

途中まで
