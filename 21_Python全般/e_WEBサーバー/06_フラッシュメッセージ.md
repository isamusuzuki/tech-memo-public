# フラッシュメッセージを使う

作成日 2025/12/02

## 1. 公式ドキュメント（英語）を読む

[Message Flashing](https://flask.palletsprojects.com/en/stable/api/#message-flashing)

`flask.Flash(message, category='message')`

次のリクエストでメッセージをフラッシュさせる。フラッシュ・メッセージをセッションから削除し、ユーザーにそれを表示させるには、テンプレートで、`get_flashed_messages()`を呼び出す必要がある

`flask.get_flashed_messages(with_categories=False, category_filter=())`

セッションから全てのフラッシュ・メッセージを引き出し、それを戻す

## 2. AIが教えてくれたサンプルコード

templates/index.html

```html
<!DOCTYPE html>
<html>
<head>
    <title>htmx with Flask</title>
    <script src="/static/htmx-1.8.0.js"></script>
</head>
<body>
    <h1>htmxでメッセージを取得</h1>
    <button hx-post="/add-message">メッセージを追加</button>
    <button hx-get="/get-messages" hx-target="#message-container">メッセージを取得</button>
    <div id="message-container"></div>
</body>
</html>
```

templates/messages.html

```html
{% for msg in messages %}
    <p>{{ msg }}</p>
{% endfor %}
```

app.py

```python
from flask import Flask, flash, render_template, request, get_flashed_messages
import random

app = Flask(__name__)
app.secret_key = 'your_secret_key' # flashを使うにはsecret_keyが必要

@app.route('/')
def index():
    return render_template('index.html')

@app.route('/add-message', methods=['POST'])
def add_message():
    random_int = random.randint(1, 10)
    flash(f'これは追加されたメッセージです！{random_int}')
    return f'メッセージを追加 {random_int}'

@app.route('/get-messages', methods=['GET'])
def get_messages():
    messages = get_flashed_messages()
    return render_template('messages.html', messages=messages)
```
