# ファイルを読み書きする

作成日 2020/02/04

## 01. JSON ファイルを吐き出す

```bash
$vo = @{
  'password' = $password
  'filename' = "$($name).zip"
  'title' = "$($name) 当落作業用リスト"
  'text' = ""
}
$vo | ConvertTo-Json | Out-File ".\temp\$($name)_mail.json" -Encoding utf8
```

## 02. 取得したオブジェクトを JSON ファイルに書き出す

```bash
[System.Net.IPAddress]::Any | ConvertTo-Json | Out-File "C:\Users\{user-name}\Desktop\test.json" -Encoding utf8
```

## 03. JSON ファイルを読み取ってオブジェクトに変換する

```bash
Get-Content C:\Users\{user-name}\Desktop\test.json -Encoding utf8 -Raw | ConvertFrom-Json
```

## 04. JSON ファイルを読み取って繰り返し作業をする

momoclo.json

```json
{
  "members": [
    { "name": "momota", "color": "red" },
    { "name": "tamai", "color": "yellow" },
    { "name": "ariyasu", "color": "green" },
    { "name": "sasaki", "color": "pink" },
    { "name": "takagi", "color": "purple" }
  ]
}
```

test.ps1

```bash
$momoclo = Get-Content C:\Users\{user-name}\momoclo.json -Encoding utf8 -Raw | ConvertFrom-Json

foreach ($member in $momoclo.members) {
    # Write-Host $member.name "is" $member.color "!\n"
    Write-Output $member.name $member.color
}
```

- PowerShell では文字列間を明示的に結合する必要がない
- Write-Host では、文字列間に空白が挿入される
- Write-Output では、最後に改行が挿入される
