# タスクスケジューラーにスクリプトを登録する

作成日 2020/02/04

## 1. 最初に種明かし

1 行だけの PowerShell スクリプトをつくっておいて、それをタスクスケジューラに登録する

aihara.ps1 => `node ./aihara.js`\
andy.ps1 => `python ./andy.py >> ./temp/andy.log`

## 2. タスクスケジューラを起動する

コントロールパネル ＞ 右上、表示方法 ＞ 小さいアイコンに変更
＞ 管理ツール ＞ タスク スケジューラ ＞ 「タスク スケジューラ」ウィンドウが登場

## 3. タスクを作成する

左枠 ＞ タスク スケジューラ(ローカル)\
右枠 ＞ 操作 ＞ 「タスクの作成...」をクリック（基本にあらず） ＞ 「タスクの作成」ダイアログが登場

### 全般タブ

名前を入力する ＞ Aihara

セキュリティオプション ＞ 「ユーザーがログオンしているかどうかにかかわらず実行する」を選択

### トリガータブ

新規ボタンをクリック ＞ 「新しいトリガー」ダイアログが登場

| Key      | Value               |
| -------- | ------------------- |
| 設定     | 毎日                |
| 開始     | 2017/07/08 08:00:00 |
| 間隔     | 1 日                |
| 有効期限 | 2018/07/07 16:10:02 |

OK ボタンをクリック

### 操作タブ

新規ボタンをクリック ＞ 「新しい操作」ダイアログが登場

| Key                   | Value                                                       |
| --------------------- | ----------------------------------------------------------- |
| 操作                  | プログラムの開始                                            |
| プログラム/スクリプト | `C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe` |
| 引数の追加            | `-Command "C:\Users\USER-NAME\PROJECT-NAME\aihara.ps1"`     |
| 開始                  | `C:\Users\USER-NAME\PROJECT-NAME`                           |

OK ボタンをクリック\
タスクの作成ウィンドウの OK ボタンをクリック ＞ パスワードを入力（ユーザーのログインパスワード）

## 4. イベントログを有効にする

コントロールパネル ＞ 右上、表示方法 ＞ 小さいアイコンに変更\
＞ 管理ツール ＞ イベントビューアー ＞ 「イベント ビューアー」ウィンドウが登場\
＞ 左枠 ＞ アプリケーションとサービスログ ＞ Microsoft ＞ Windows ＞ TaskScheduler\
＞ Operational ＞ 右クリックしてプロパティ\
＞ 「ログのプロパティ」ウィンドウが登場\
＞ 「ログを有効にする」にチェックを入れる ＞ OK ボタンをクリック
