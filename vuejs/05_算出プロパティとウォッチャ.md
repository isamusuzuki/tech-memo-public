# 算出プロパティとウォッチャ

作成日 2020/12/21

[算出プロパティとウォッチャ — Vue\.js](https://jp.vuejs.org/v2/guide/computed.html)

## 01. 自分が書いた算出プロパティの例

```javascript
const CatWord = {
  props: ['element', 'index'],
  computed: {
    show_delimiter: function () {
      const total_number = parseInt(this.element.total, 10);
      if (this.index + 1 === total_number) {
        return false;
      } else {
        return true;
      }
    },
  },
  template: `
        <span>
            <span style="text-decoration: underline; cursor: pointer"
                v-text="element.word">
            </span>
            <span v-if="show_delimiter" v-text="element.delimiter"></span>
        </span>
    `,
};
```

- CatWord コンポーネントは、以下のように、v-for ディレクティブを使って、複数個並べられる
- 最後だけ、区切り文字を表示させたくない
- show_delimiter を算出プロパティにすることで、それを可能にしている
- element オブジェクトの中身は `{word: '', total: 0, delimiter: ''}` となっている

```html
<span>
  <catword
    v-for="(element, index) in elements"
    v-bind:element="element"
    v-bind:key="element.word"
    v-bind:index="index"
  ></catword>
</span>
```

## 02. 自分が書いたウォッチャの例

```javascript
const CatPath = {
    data: function () {
        return {
            elements: [],
        };
    },
    props: ['cat'],
    watch: {
        cat: function () {
            this.dissolve();
        },
    },
    components: {
        word: Word,
    },
    template: `
        <span>
            <catword v-for="(element, index) in elements" v-bind:element="element" v-bind:key="element.word"
            v-bind:index="index"></catword>
        </span>
    `,
    methods: {
        dissolve() {
            this.elements = [];
            const path_list = this.cat.category_path.split(this.cat.delimiter);
            const total = path_list.length;
            path_list.map((x) => {
                this.elements.push({
                    word: x.trim(),
                    total: total,
                    delimiter: this.cat.delimiter + ' ',
                });
            });
        },
    },
    mounted() {
        this.dissolve();
    },
};
```

- CatPath コンポーネントは、親コンポーネントから与えられた cat オブジェクトを分解する
- 分解メソッドは、マウントした時も実行するが、cat オブジェクトが変わったときにも実行する
- cat オブジェクトの中身は `{category_path: '', delimiter: ''}` となっている

```html
<span>
    <catpath v-bind:cat="cat"></catpath>
</span>
```
