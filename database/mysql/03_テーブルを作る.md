# テーブルを作る

作成日 2020/02/01、更新日 2020/02/18

## 01. CREATE TABLE クエリー

```sql
CREATE TABLE `logs` (
    `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
    `category` varchar(100) NOT NULL,
    `name` varchar(100) NOT NULL,
    `success` tinyint(1) NOT NULL COMMENT '1:true,0:false',
    `message` text DEFAULT NULL,
    `created_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY (`id`)
);

INSERT INTO logs (category, name, success, message)
VALUES ('tech-memo', 'admin', 1, 'これはテストです。無視してください');

select id, category, name, success, message, created_at
from logs
order by id desc
limit 100;
```
## 02. ALTER TABLEクエリー

後からカラムを追加することが可能\
`AFTER` を使うと、カラム位置を指定することが可能

```sql
ALTER TABLE m_malls
ADD fee double NOT NULL DEFAULT 0 AFTER mall_name
```

## 03. カラムのデフォルト値にタイムスタンプを使う

current_date, current_time, current_timestampの3つは、\
`()` 括弧なしで、変数っぽく使うことも可能

```sql
create table sample (
  id         int,
  val        varchar(16),
  created_at timestamp not null default current_timestamp,
  updated_at timestamp not null default current_timestamp on update current_timestamp,
  primary key(id)
);

insert into sample (id, val) values (1, 'aaa');
-- 作成日時と更新日時の両方に同じ日付が入る

update sample set val = 'bbb' where id = 1;
-- 更新日時だけが変わる

update sample set val = 'bbb' where id = 1;
-- UPDATEしても値が変わっていない場合は、更新日時も変わらない
```
