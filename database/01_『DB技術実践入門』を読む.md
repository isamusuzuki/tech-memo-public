# 『データベース技術実践入門』を読む

作成日 2019/12/15

## P.232 列指向データベースとは

DWH と相性のよいデータベース\
Column-Oriented Database

### 列指向データベースのメリット

1. 必要な列だけがアクセスされ、I/O 効率が高い
1. 圧縮効率が良い。DWH レベルになると、カーディナリティ（列値のばらつき）が小さくなる => 列単位で値を圧縮すると、データサイズを大きく縮める
1. ロード処理が高速 => 標準的な B+Tree インデックス機構をもたないため

### 列指向データベースのデメリット

1. 主キー検索などの狭い範囲の処理が遅い。そもそもインデックスを持たないので、一意性の保証ができない
1. 製品としての成熟度が低い

1 秒間に数千〜数万クエリを処理するといった高速な応答時間（レスポンスタイム）が求められる用途に合わない

## P.23 B+Tree インデックスとは

文字通り木構造になったインデックス

頂上がルートプロック\
最下尾がリーフブロック\
その間にブランチブロックが入る

ルートブロックやブランチブロックには、検索のキーになるユーザ ID に対して、対象のブロックがどこにあるかという情報がある

リーフブロックには、実際のデータ領域での格納位置の情報がある

### 二分木

ブランチやリーフの枝分かれ本数が 2 本しかない\
計算量 O(log2N)

### 多分木

枝分かれ本数が数十本から数百本\
B+Tree インデックスはこちら\
計算量 O(logmN)

## P.17 線形探索

単純なテキストファイルを全部読む\
検索にかかる時間は文書サイズに比例する\
アルゴリズム的には、O(N)の計算量\
データ件数が N 倍になれば、N 倍の計算量（時間）がかかる\
検索アルゴリズムの中で、最も効率が悪い

## P.21 ハッシュインデックス

キーの値をハッシュ関数にかけて、そのハッシュ値と値のペアをもつ\
ハッシュ値は文字列長によらず同じサイズになる => 固定値フォーマットになる\
ハッシュ計算にかかるコストはデータ量に依存しない => データが増えても計算量は変わらない\
計算量は O(1)\
最も高速なアルゴリズムに分類される

### ハッシュの衝突

異なるキー値なのに、ハッシュ値が同じになること\
衝突を検知して、実際に一致しているかどうかをチェックする仕組みが必要

### ハッシュインデックスのデメリット

ハッシュインデックスは、範囲検索が得意でない

## P.24 B-Tree インデックス

すべての値をリーフブロックが持つとは限らず、ブランチブロックで持つこともあるというデータ構造

## P.25 B+Tree インデックス再び

イコール検索はもちろん、不等号や前方一致検索といった範囲系の検索も得意

## この書籍について

- タイトル: web エンジニアのためのデータベース技術実践入門
- 著者: 松信嘉範
- 出版社: 技術評論社
- 発行年: 2012

もう絶版になっている古い書籍ではあるが、内容は一級品だと思うので、本棚に並べておく
